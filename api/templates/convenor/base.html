{% if not snippet %}
<!DOCTYPE html>
<html lang="en">
  <head>
    {% if title %}
    <title>{{title}} - MLSB</title>
    {% else %}
    <title>MLSB</title>
    {% endif %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="MLSB web app">
    <meta name="author" content="Dallas Fraser">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
   	<link href="{{ url_for('static', filename="css/bootstrap.min.css") }}" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename="css/convenor/simple-sidebar.css") }}" rel="stylesheet">
    <link href="{{ url_for('static', filename="css/convenor/documentation.css") }}" rel="stylesheet">
    <link href="{{ url_for('static', filename="css/convenor/admin.css") }}" rel="stylesheet">
    <link href="{{ url_for('static', filename="css/convenor/chosen.css") }}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet" />

    {% block header %}
    {% endblock %}
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- bootstrap js -->
    <script src="{{ url_for('static', filename="js/bootstrap.min.js") }}"></script>
    <script src="{{ url_for('static', filename="js/chosen.jquery.min.js") }}"></script>
    <script src="https://unpkg.com/hyperscript.org@0.9.12"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10" language="JavaScript"></script>
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
  </head>
  <body>
      <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.players_page') }}"
                      hx-get="{{ url_for('convenor.players_page') }}"
                      hx-target="#convenorBody"
                      hx-push-url="true"
                    >
                      Players
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.teams_page') }}"
                      hx-get="{{ url_for('convenor.teams_page') }}"
                      hx-target="#convenorBody"
                      hx-push-url="true"
                    >
                      Teams
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.sponsors_page') }}"
                      hx-get="{{ url_for('convenor.sponsors_page') }}"
                      hx-target="#convenorBody"
                      hx-push-url="true"
                    >
                      Sponsors
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.games_page') }}"
                      hx-get="{{ url_for('convenor.games_page') }}"
                      hx-target="#convenorBody"
                      hx-push-url="true"
                    >
                      Games
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.events_page') }}"
                    >
                      Events
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                    <a
                      href="{{ url_for('convenor.leagues_page') }}"
                      hx-get="{{ url_for('convenor.leagues_page') }}"
                      hx-target="#convenorBody"
                      hx-push-url="true"
                    >
                      Leagues & Divisions
                    </a>
                </li>
                <li class="indent-nav editsSidebar">
                  <a
                    href="{{ url_for('convenor.fun_page') }}"
                    hx-get="{{ url_for('convenor.fun_page') }}"
                    hx-target="#convenorBody"
                    hx-push-url="true"
                  >
                    Fun
                  </a>
                </li>
                <li class="indent-nav editsSidebar">
                  <a
                    href="{{ url_for('convenor.blog_posts_page') }}"
                    hx-get="{{ url_for('convenor.blog_posts_page') }}"
                    hx-target="#convenorBody"
                    hx-push-url="true"
                  >
                    Blog posts
                  </a>
                </li>
            </ul>
        </div><!-- /#sidebar-wrapper -->
        <!-- Page Content -->

        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row mobile-only">
                          <a
                            href="{{ url_for('convenor.players_page') }}"
                            hx-get="{{ url_for('convenor.players_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                            Players
                          </a>
                          <a
                            href="{{ url_for('convenor.teams_page') }}"
                            hx-get="{{ url_for('convenor.teams_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                            Teams
                          </a>
                          <a
                            href="{{ url_for('convenor.sponsors_page') }}"
                            hx-get="{{ url_for('convenor.sponsors_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                            Sponsors
                          </a>
                          <a
                            href="{{ url_for('convenor.games_page') }}"
                            hx-get="{{ url_for('convenor.games_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                            Games
                          </a>
                          <a
                            href="{{ url_for('convenor.events_page') }}"
                          >
                            Events
                          </a>
                          <a
                            href="{{ url_for('convenor.leagues_page') }}"
                            hx-get="{{ url_for('convenor.leagues_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                            Leagues & Divisions
                          </a>
                          <a
                            href="{{ url_for('convenor.fun_page') }}"
                            hx-get="{{ url_for('convenor.fun_page') }}"
                            hx-target="#convenorBody"
                            hx-push-url="true"
                          >
                          Fun
                        </a>
                        <a
                          href="{{ url_for('convenor.blog_posts_page') }}"
                          hx-get="{{ url_for('convenor.blog_posts_page') }}"
                          hx-target="#convenorBody"
                          hx-push-url="true"
                        >
                        Blog Posts
                      </a>
                </div>
                <div class="row">
                    <div class="col-lg-12" id="convenorBody">
{% endif %}
                        {% with messages = get_flashed_messages() %}
                          {% if messages %}

                            {% for message in messages %}
                            <div class="alert alert-success alert-dismissible" role="alert">
                                {{message}}
                              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            {% endfor %}
                          {% endif %}
                        {% endwith %}
                        {% block content %}{% endblock %}
{% if not snippet %}
                    </div>
                </div>
            </div>
        </div><!-- /#page-content-wrapper -->
    </div><!-- /#wrapper -->
  </body>
  <script>
    function inLineImageHandler(quill) {
      const fileInput = document.createElement('input');
      fileInput.setAttribute('type', 'file');
      fileInput.setAttribute('accept', 'image/*');
      
      fileInput.click();
  
      fileInput.onchange = function () {
        const file = fileInput.files[0];
        
        if (file) {
          var formData = new FormData();
          formData.append('image', file);
          fetch(`{{ url_for ('convenor.upload_inline_image') }}`, {
            method: 'POST',
            body: formData
          })
          .then((response => response.json()))
          .then(data => {
            const imageUrl = data.url;
            const range = quill.getSelection();
            quill.insertEmbed(range.index, 'image', imageUrl);
          })
          .catch(error => {
            console.error('Error uploading image:', error);
          })
          .finally(() => {
            fileInput.remove();
          });
        } else {
          fileInput.remove();
        }
      };
    }
    function createQuillEditorAux(editorId, inputId, value, placeholder, allowImages) {
        const modules = (allowImages) ? {
          toolbar: [
            ['bold', 'italic', 'underline', 'strike'],
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            [{ 'indent': '-1'}, { 'indent': '+1' }], 
            ['link', 'image'],
          ],
        } : {};
        const quill = new Quill(`#${editorId}`, {
          placeholder: placeholder,
          theme: 'snow',
          modules,
        });
        quill.on('text-change', function(delta, oldDelta, source) {
          $(`#${inputId}`).val(quill.container.firstChild.innerHTML);
        });
        if (value && value != 'None') {
          const delta = quill.clipboard.convert({ html: value });
          quill.setContents(delta, 'silent')
        }
        if (allowImages) {
          const handler = inLineImageHandler.bind(null, quill);
          quill.getModule('toolbar').addHandler('image', handler);
        }
        return quill;
      }


    function createQuillEditor(editorId, inputId, value, placeholder, allowImages) {
      if (document.readyState === "complete") {
        return createQuillEditorAux(editorId, inputId, value, placeholder, allowImages);
      } else {
        // Wait for the load event
        window.addEventListener("load", function () {
          return createQuillEditorAux(editorId, inputId, value, placeholder, allowImages);
        });
      }
    }

  </script>
  <footer class="footer text-center">
    <a class="btn btn-mini btn-link " href="{{ url_for('website.about', year=year) }}">About</a>
    <a class="btn btn-mini btn-link " href="/rest/swagger">Documentation</a>
    <a class="btn btn-mini btn-link " href="https://github.com/fras2560"> Author</a>
    <a class="btn btn-mini btn-link " href="https://jquery.com/">jQuery</a>
    <a class="btn btn-mini btn-link " href="https://getbootstrap.com/docs/3.4/">Bootstrap 3</a>
    <a class="btn btn-mini btn-link " href="https://flask.palletsprojects.com/en/2.0.x/config/">Flask 2</a>
    <a class="btn btn-mini btn-link " href="https://htmx.org/">HTMX</a>
  </footer>
</html>
{% endif %}